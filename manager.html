<!-- manager.html -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Manager Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
  :root{--bg:#ffffff;--card:#f6f9fc;--accent:#00a6c2;--text:#0b2b3a;--muted:#6b7c86}
  body{margin:0;background:linear-gradient(180deg,#ffffff 0,#f3f7fb 100%);font-family:Inter,system-ui;color:var(--text)}
  header{display:flex;align-items:center;justify-content:space-between;padding:18px 36px}
  .wrap{max-width:1200px;margin:0 auto;padding:18px}
  .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:0 6px 20px rgba(14,30,37,0.06)}
  .logo img{width:56px;height:56px;border-radius:8px}
  .form-row{display:flex;gap:12px;margin-top:12px}
  input,select{padding:12px;border-radius:8px;border:1px solid #d7e2ea;background:white}
  button{background:var(--accent);color:white;padding:10px 14px;border-radius:10px;border:none;cursor:pointer}
  table{width:100%;border-collapse:collapse;margin-top:18px}
  th,td{padding:12px;border-bottom:1px solid #e6eef6}
  .error{color:#c94a4a;margin-top:8px}
</style>
</head>
<body>
<header>
  <div style="display:flex;align-items:center;gap:12px" class="logo"><img src="https://i.ibb.co/1GrhnMc4/images.jpg" alt="logo"><div><div style="font-size:12px;color:var(--muted)">Manager</div><div style="font-weight:700">Manager Dashboard</div></div></div>
  <div><button id="logoutBtn">Logout</button></div>
</header>

<div class="wrap">
  <div class="card">
    <h2>Add Agent</h2>
    <div class="form-row">
      <input id="aName" placeholder="Name">
      <input id="aEmail" placeholder="Email">
      <input id="aPwd" placeholder="Password">
      <select id="aTeam">
        <option value="">Select team</option>
        <option value="1">Sales</option>
        <option value="2">ClientCare</option>
      </select>
      <input id="aTarget" placeholder="Target (R)" type="number" value="0">
      <button id="addAgentBtn">Add</button>
    </div>
    <div id="mgrError" class="error"></div>
  </div>

  <div style="height:18px"></div>

  <div class="card">
    <h2>Agent Performance</h2>
    <div style="display:flex;justify-content:flex-end;gap:12px"><input id="monthPicker" type="month"><button id="downloadCSV">Download CSV</button></div>
    <table>
      <thead><tr><th>Name</th><th>Team</th><th>Target (R)</th><th>Month Sales (R)</th><th>Progress</th><th>Status</th><th>Actions</th></tr></thead>
      <tbody id="agentsTable"></tbody>
    </table>
  </div>
</div>

<script>
document.getElementById('logoutBtn').addEventListener('click', () => {
  localStorage.clear();
  window.location.href = 'index.html';
});

const addBtn = document.getElementById('addAgentBtn');
const agentsTable = document.getElementById('agentsTable');

function loadAgents() {
  const agents = JSON.parse(localStorage.getItem('agents') || '[]');
  agentsTable.innerHTML = agents.map((a, i) => {
    const progress = a.target > 0 ? (a.sales / a.target) * 100 : 0;
    const status = progress < 30 ? 'At Risk' : progress < 80 ? 'On Track' : 'Ahead';
    return `
      <tr>
        <td>${a.name}</td>
        <td>${a.team}</td>
        <td>${a.target.toLocaleString()}</td>
        <td>${a.sales.toLocaleString()}</td>
        <td>${progress.toFixed(1)}%</td>
        <td>${status}</td>
        <td><button onclick="deleteAgent(${i})">Delete</button></td>
      </tr>`;
  }).join('');
}

window.deleteAgent = (index) => {
  const agents = JSON.parse(localStorage.getItem('agents') || '[]');
  agents.splice(index, 1);
  localStorage.setItem('agents', JSON.stringify(agents));
  loadAgents();
};

addBtn.addEventListener('click', () => {
  const name = document.getElementById('aName').value.trim();
  const email = document.getElementById('aEmail').value.trim();
  const team = document.getElementById('aTeam').value;
  const target = Number(document.getElementById('aTarget').value || 0);

  if (!name || !email || !team) return alert('Please fill all fields');

  const agents = JSON.parse(localStorage.getItem('agents') || '[]');
  agents.push({ name, email, team, target, sales: 0 });
  localStorage.setItem('agents', JSON.stringify(agents));

  document.getElementById('aName').value = '';
  document.getElementById('aEmail').value = '';
  document.getElementById('aTarget').value = '';

  loadAgents();
});

loadAgents();
</script>

</body>
</html>
